{"title":"Evictions by San Francisco Neighborhood, 1999-2015","cells":[{"content":"","id":2,"cellType":"dom","rendered":false,"selected":false,"executionStatus":" ","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED","elementType":"div","domElementID":"by-neighborhood"},{"content":"## Code","id":8,"cellType":"markdown","value":"<h2>Code</h2>\n","rendered":true,"selected":false,"executionStatus":" ","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED"},{"content":"https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.2/d3.js\nhttps://cdn.rawgit.com/hamilton/67d7904af5cd696ec2b12450b69bd657/raw/fd768a81ffb431fc7c843055f4cd1ee07af5ff50/metricsgraphics.min.js\ntools/nb-tools.js","id":4,"cellType":"external scripts","value":"loaded scripts","rendered":true,"selected":false,"executionStatus":"13","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED"},{"content":"__TODO__: (external css - need to roll this into 'external scripts')\n<link href='https://cdn.rawgit.com/hamilton/67d7904af5cd696ec2b12450b69bd657/raw/fd768a81ffb431fc7c843055f4cd1ee07af5ff50/metricsgraphics.css' rel='stylesheet' type='text/css'>\n","id":6,"cellType":"markdown","value":"<p><strong>TODO</strong>: (external css - need to roll this into 'external scripts')</p>\n<link href='https://cdn.rawgit.com/hamilton/67d7904af5cd696ec2b12450b69bd657/raw/fd768a81ffb431fc7c843055f4cd1ee07af5ff50/metricsgraphics.css' rel='stylesheet' type='text/css'>\n","rendered":true,"selected":false,"executionStatus":" ","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED","elementType":"div","domElementID":"dom-cell-6"},{"content":"//'by-neighborhood.csv'\nlet URL = 'https://gist.githubusercontent.com/hamilton/67d7904af5cd696ec2b12450b69bd657/raw/15d83f7f281c3e5de2ca3359529ef041b47fcbf6/css'\nvar data = d3.csvParse(NB.getData(URL))\n","id":3,"cellType":"javascript","rendered":true,"selected":false,"executionStatus":"14","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED"},{"content":"var strip_punctuation = function(s) {\n    var punctuationless = s.replace(/[^a-zA-Z0-9 _]+/g, '');\n    var finalString = punctuationless.replace(/ +?/g, '');\n    return finalString;\n}\n\nfunction showNeighborhoodEvictions(data) {\n    data = MG.convert.date(data, 'date');\n    data = MG.convert.number(data, 'count');\n    var each_neighborhood = {};\n    var which_neighborhoods = {};\n    data.forEach(function(d){\n        var n=d.nbrhd;\n        if (!each_neighborhood.hasOwnProperty(n)) each_neighborhood[n]=[];\n        each_neighborhood[n].push(MG.clone(d));\n        if (!which_neighborhoods.hasOwnProperty(n)) which_neighborhoods[n]=0;\n        which_neighborhoods[n]+= d.count;\n    })\n    // sort by most interesting neighborhoods\n    var nord=[];\n    Object.keys(which_neighborhoods).forEach(function(d){\n        nord.push([which_neighborhoods[d], d]);\n    })\n    nord.sort(function(a,b){return b[0]-a[0]});\n    nord = nord.map(function(d){return d[1]});\n    var c = 0;\n\td3.select('div#by-neighborhood svg').remove()\n    var neigh = d3.select('div#by-neighborhood').append('div');\n    var row = neigh.append('div').classed('row', true);\n\n\n\n    var test = nord.slice(1,4).map(function(n){\n        return each_neighborhood[n];\n    });\n  \n    nord.forEach(function(neighborhood,i){\n        if (c < 24){\n            var n = strip_punctuation(neighborhood)\n            var all = row.append('div').classed(n, true).classed('neighborhood', true).classed('col-md-2', true);\n\n            MG.data_graphic({\n                title: neighborhood,\n                data: each_neighborhood[neighborhood],\n                width: 175,\n                height:155,\n                max_y:350,\n                mouseover_align:'center',\n                left: i===0 ? 30 : 15,\n                right:i===0 ? 15 : 15,\n                top:45,\n                xax_count:3,\n                y_axis: i == 0 ? true : false,\n                min_x: new Date('1996-12-31'),\n                show_secondary_x_label: false,\n                area:false,\n                linked:true,\n                color:'black',\n                xax_format: function(d){return d3.timeFormat('%Y')(d)},\n                x_rollover_format: '%Y  ',\n                y_rollover_format: function(d) { return d.count + ' evictions'},\n                target: 'div.'+n,\n                x_accessor: 'date',\n                y_accessor: 'count',\n                small_text: false,\n            });\n            if (c+1 % 6 === 0) row = neigh.append('div').classed('row', true);\n\n        }\n        c +=1;\n\n    })\n}","id":9,"cellType":"javascript","rendered":true,"selected":true,"executionStatus":"15","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED"},{"content":"showNeighborhoodEvictions(data)","id":10,"cellType":"javascript","rendered":true,"selected":false,"executionStatus":"16","evaluationOld":true,"collapseEditViewInput":"EXPANDED","collapseEditViewOutput":"EXPANDED","collapsePresentationViewInput":"COLLAPSED","collapsePresentationViewOutput":"EXPANDED"}],"declaredProperties":{},"lastSaved":"2017-10-12T21:15:52.425Z","mode":"edit","viewMode":"editor","history":[],"externalScripts":[],"executionNumber":0,"currentlySelected":{"content":"## Code","id":8,"cellType":"markdown","rendered":true,"selected":true,"value":"<h2 id=\"code\">Code</h2>\n"}}